# Desktop Info by Glenn Delahoy
# Sample preconfigure configuration file
# See the manual for a full description of the preconfigure option

[options]
font-size=10
font-face=Arial

# size and position
top=0
right=0

# logging
log=%appdata%\DesktopInfo\desktopinfo.log
log-level=debugonerror

# misc
ignore-setting-change=1
allowdrag=0

[screen-saver]
font-size=16
centerv=1
centerh=1
formcolor=501020

[text]
noresults=<n/a>
error=[error]
null-result=<null>
unknown=Unknown
executing=<executing>
nav-previous=Previous Page
nav-home=Home Page
nav-next=Next Page

[items]

# colors
set White   = #ffffff
set Grey    = #909090
set Cyan    = #00ffff
set Magenta = #ff00ff
set Green   = #00ff00
set Orange  = #ffd000
set Yellow  = #ffff00
set Silver  = #d0d0d0
set Blue    = #0000f0
set Red     = #ff0000

# battery status lookup table
set battery1      = Disconnected
set battery2      = Connected
set battery3      = Fully Charged
set battery<null> = Not In Use
	
# date/time
PAGE=1
PAGE-TITLE=Home Page
COLOR=%Cyan%

DATETIME=interval:10,display:%9 %10
WMI=interval:60,hide-no-result:1,id:battery,text:Battery,alarms:(%15 le 40 %red%),namespace:root\cimv2,query:Win32_Battery,display:%EstimatedChargeRemaining%% (%battery%BatteryStatus%%)

# cpu
CORETEMP=interval:10,hide-no-result:1,display:%1%2 (%5)
WMI=interval:10,id:temp,hide-no-result:1,text:Cpu Temp,namespace:root\wmi,query:MSAcpi_ThermalZoneTemperature,display: {{%CurrentTemperature%/10-273.15}}[1.0f]C / {{%CriticalTripPoint%/10-273.15}}[1.0f]C
CPU=interval:2,background-interval:10,chart:line max:100 series1:1 color1:00ff00 series2:2 color2:bb00bb,alarms:(%1 ge 80 %red%)(%2 ge 40 %red%),display:Tot: %1[2.0f]%\, Krnl: %2[2.0f]%\, Queue: %3
TOPPROCESSCPU=interval:2,font-size:80%,text:Top Cpu,display:%1 (pid:%2) %3[1.1f]%

COLOR=b0ffb0

# memory
COMMENT=text:,font-size:50%
PHYSICALRAM=interval:30,font-size:120%,alarms:(%3 ge 80 0000FF),display:%1[3.1b]B / %2[3.1b]B (%3% used)
TOPPROCESSMEM=interval:10,font-size:80%,text:Top Memory,display:%1 (pid:%2) %3[1.1b]B
PAGEFAULTS=interval:10,font-size:100%,alarms:(%5 le 80 2222bb),display:Tot: %1\, Hrd: %2\, Hit: %5%

COLOR=%Orange%

# network
COMMENT=text:,font-size:50%
# check the 'where' clause on these two
WMI=interval:3,id:wifi,hide-no-result:1,font-size:80%,chart:line scale:log series1:1 color1:00ff00 series2:2 color2:bb00bb,alarms:(%1 ge {{%CurrentBandwidth%/8*95/100}} 2222ee)(%2 ge {{%CurrentBandwidth%/8*95/100}} #ff0000),text:Wifi Traffic,namespace:root\cimv2,query:Win32_PerfFormattedData_Tcpip_NetworkInterface where Name like "%Wireless%",display:R: %BytesReceivedPersec%[3.1b]Bps\, S: %BytesSentPersec%[3.1b]Bps\, B: {{%CurrentBandwidth%/8}}[1.0B]Bps
WMI=interval:3,id:eth, hide-no-result:1,font-size:80%,chart:line scale:log series1:1 color1:00ff00 series2:2 color2:bb00bb,alarms:(%1 ge {{%CurrentBandwidth%/8*95/100}} 2222ee)(%2 ge {{%CurrentBandwidth%/8*95/100}} 0000ff),text:Ethernet Traffic,namespace:root\cimv2,query:Win32_PerfFormattedData_Tcpip_NetworkInterface where Name like "%Ethernet%" and CurrentBandwidth>0,display:R: %BytesReceivedPersec%[3.1b]Bps\, S: %BytesSentPersec%[3.1b]Bps\, B: {{%CurrentBandwidth%/8}}[1.0B]Bps

COLOR=%Silver%

# disks
COMMENT=text:,font-size:50%
LOGICALDRIVES=interval:5,diskio:1,font-size:85%,chart:bar max:100 series1:7 threshold:75,alarms:(%11 ge 10000000 0000f0)(%13 ge 10000000 0000f0)(%7 ge 90 0070f0), row-text:Drive %1: (%2)| %3,display:%6[1.0B]B/%5[1.0B]B (%7[1.1f]% used)|%chart%| r: %11[1.1B]B/s\, w: %13[1.1B]B/s\, q: %17\, i: %19%| avg read: {{%15*1000}}[1.2f]ms\, write: {{%16*1000}}[1.2f]ms

# windows
PAGE=2
PAGE-TITLE=Windows
COLOR=%Cyan%

COMMENT=color:%White%,style:iwb,text:Dates / Times
DATETIME=interval:10,display:%9 %10
TIMEZONE=interval:3600,display:%1 (%2)
WMI=interval:3600,text:Daylight Savings,namespace:root\cimv2,query:CIM_ComputerSystem,display:Enabled: %EnableDaylightSavingsTime%[b:Yes:No]\, In Effect: %DaylightInEffect%[b:Yes:No]
BOOTTIME=display:%9 %10
UPTIME=interval:60,display:%1 days %2 hrs %3 mins
COMMENT=text:,font-size:50%

COLOR=%White%

# windows configuration
COMMENT=color:%White%,style:iwb,text:Windows Configuration
REG=value:HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ReleaseId,set:releaseid,hidden:1
WMI=id:os,text:Windows,namespace:root\cimv2,query:Win32_OperatingSystem,display:%caption% %releaseid%|Architecture: %OSArchitecture%|Installed: %InstallDate_day% %InstallDate_month%[mmm] %Installdate_year% %installdate_utcoffset%|Win Dir: %WindowsDirectory%|Sys Dir: %SystemDirectory%
OSBUILD=display:%1 (%2.%3 Build %4)
SERVICEPACK=hide-no-result:1
USER=set:username,hidden:1
HOST=text:Host/User,display:%1/%username%
REG=interval:600,text:Firewall,value:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\SharedAccess\Parameters\FirewallPolicy\DomainProfile\EnableFirewall,display:%1[b:Active:Not Active]
REG=interval:600,hide-no-result:1,text:Auto Update,value:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\Results\Install\LastSuccessTime,display:%1
REG=interval:600,text:UAC Enabled,value:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA,display:%1[b:Enabled:Disabled]
#Secureboot/UEFI status
REG=interval:600,text:Secure Boot Status,value:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecureBoot\State\UEFISecureBootEnabled,display:%1[b:Enabled:Disabled]
IEVERSION
DIRECTX

# system event logs
PAGE=3
PAGE-TITLE=System Event Logs
COLOR=%White%

COMMENT=style:iwb,text:System Event Logs
EVENTLOG=interval:60,font-size:80%,log:System,maxrows:5, row-text:%1| ID: %2| Type: %3\, Task: %4, display:Source: %5|Computer: %6|%7|%8|%9|%10

PAGE=4
PAGE-TITLE=Application Event Logs

# application event logs
COMMENT=style:iwb,text:Application Event Logs
EVENTLOG=interval:60,font-size:80%,log:Application,maxrows:5, row-text:%1| ID: %2| Type: %3\, Task: %4, display:Source: %5|Computer: %6|%7|%8|%9|%10

# network
PAGE=5
PAGE-TITLE=Network
COLOR=%Silver%

COMMENT=color:%White%,style:iwb,text:Network
HOST
USER
DOMAIN=hide-no-result:1
DOMAINCONTROLLER=hide-no-result:1
DNSSERVER
WMI=interval:600,hide-no-result:1,text:Workgroup,namespace:root\cimv2,query:Win32_ComputerSystem, display:%Workgroup%
NETCONNECTIONS=interval:5
NETPACKETS=interval:5,display:r:%1[1.0n]  s:%2[1.0n]
NETPACKETSRATE=interval:5,text:Net Rate,mtu:1500,display:r:%1[1.1b]Bps  s:%2[1.1b]Bps
WMI=interval:60,id:latency,font-size:120%,alarms:(%11 ge 34 0088f0),text:Network Latency, namespace:root\cimv2,query:Win32_PingStatus where address='google.com',display:%ResponseTime%ms (google.com)
NETWORKINTERFACES=interval:30,operstatus:1,iftype:6 23 71 243,ipv4list: %8/%10|,ipv6list:  %11|, row-text:%2,display:%8 / %10 (%14)| mac:%4| gw:%17| dns:%15| dhcp:%19| link: t:%23[1.0B]Bps\, r:%24[1.0B]Bps|  %8/%10|  %11/%13
WMI=interval:3,id:wifi2,background-interval:60,hide-no-result:1,font-size:80%,chart:line scale:log series1:1 color1:00ff00 series2:2 color2:bb00bb,alarms:(%1 ge 3500000 0000ff)(%2 ge 1000000 ff0000),text:Wifi Traffic,namespace:root\cimv2,query:Win32_PerfFormattedData_Tcpip_NetworkInterface where Name like "%Wireless%" and CurrentBandwidth>0,display:R: %BytesReceivedPersec%[3.1b]Bps\, S: %BytesSentPersec%[3.1b]Bps\, B: {{%CurrentBandwidth%/8}}[1.0B]Bps
WMI=interval:3,id:eth2, background-interval:60,hide-no-result:1,font-size:80%,chart:line scale:log series1:1 color1:00ff00 series2:2 color2:bb00bb,alarms:(%1 ge 3500000 0000ff)(%2 ge 1000000 ff0000),text:Ethernet Traffic,namespace:root\cimv2,query:Win32_PerfFormattedData_Tcpip_NetworkInterface where Name like "%Ethernet%" and CurrentBandwidth>0 ,display:R: %BytesReceivedPersec%[3.1b]Bps\, S: %BytesSentPersec%[3.1b]Bps\, B: {{%CurrentBandwidth%/8}}[1.0B]Bps
HTTPGET=interval:600,text:External ipv4,source:http://ipecho.net/plain
HTTPGET=interval:600,text:External ipv6,source:http://[ipv6.plain-text-ip.com],font-size:85%

# hardware
PAGE=6
PAGE-TITLE=Hardware
COLOR=%Cyan%

COMMENT=color:%White%,style:iwb,text:Hardware
WMI=interval:60,hide-no-result:1,text:Battery,namespace:root\cimv2,query:Win32_Battery,display:%EstimatedChargeRemaining%% (%battery%BatteryStatus%%)
OEMINFO=display:%2,hide-no-result:1
WMI=text:Motherboard,namespace:root\cimv2,query:Win32_Baseboard,display:%Manufacturer% %Product%
WMI=text:Bios,namespace:root\cimv2,query:Win32_Bios,display:%Caption%|Ser: %SerialNumber%

# display hardware
comment=text:Display Hardware,style:u,color:%white%
# get the windows major version
OSBUILD=set:winmajor=%2,hidden:1
# vista or later
IF=value1:%winmajor%,value2:6,comparator:ge
WMI=namespace:root\cimv2,query:Win32_VideoController,wide:1,display:    %caption%   (%CurrentHorizontalResolution%x%CurrentVerticalResolution%x%CurrentBitsPerPixel%)
# earlier than vista
IF=value1:%winmajor%,value2:6,comparator:lt
WMI=namespace:root\cimv2,query:Win32_DisplayControllerConfiguration,wide:1,display:    %caption%   (%HorizontalResolution%x%VerticalResolution%x%BitsPerPixel%)

comment=text:Monitors,style:u,color:%white%
WMI=namespace:root\cimv2,query:Win32_DisplayConfiguration,set:BitsPerPel=%BitsPerPel%,hidden:1
WMI=namespace:root\cimv2,query:Win32_DesktopMonitor,wide:1,display:    %caption% (%ScreenWidth%x%ScreenHeight%x%BitsPerPel%)
MONITOR=wide:1,display:    Current Monitor: %4 x %5 %7ppi Primary:%6

WMI=text:Audio Controller,namespace:root\cimv2,query:Win32_SoundDevice,display:%Caption%
WMI=interval:30,text:Printers,namespace:root\cimv2,query:Win32_Printer,maxrows:1,display:%rowcount% printers
WMI=text:Default Printer, namespace:root\cimv2,query:Win32_Printer where default = "True",display:%Name% (%Status%)
COMMENT=text:,font-size:50%

COMMENT=color:%White%,style:iwb,text:Serial Ports
WMI=interval:10,font-size:80%,id:PnPPorts,text:PnP Ports,namespace:root\cimv2,query:Win32_PnPEntity where name like "%(COM%",display:%caption%,set:deviceid
WMI=interval:10,font-size:80%,id:SerialPorts,text:Serial Ports,namespace:root\wmi,query:MSSerial_PortName,display:%PortName%\, %InstanceName%
COMMENT=text:,font-size:50%

# cpu
COMMENT=color:%White%,style:iwb,text:CPU
CPUTYPE=font-size:80%
CPUCOUNT=display:%1
WMI=interval:5,font-size:80%,text:CPU Info,namespace:root\cimv2,query:Win32_Processor,display:Cores:%NumberOfCores%|Speed:%MaxClockSpeed%MHz   Current:%CurrentClockSpeed%MHz
WMI=interval:5,text:Cpu Temp,namespace:root\wmi,query:MSAcpi_ThermalZoneTemperature,display: {{%CurrentTemperature%/10-273.15}}[1.1f]C
CPU=interval:1,background-interval:10,chart:line max:100 series1:1 color1:00ff00 series2:2 color2:0000bb,alarms:(%1 ge 80 0000ff)(%2 ge 40 0000ff),display:Tot: %1[2.0f]%\, Krnl: %2[2.0f]%\, Queue: %3
CPUUSAGE=interval:1,font-size:8,row-text:Cpu %1,chart:line max:100 series1:2 color1:00ff00 row-id:1,alarms:(%2 ge 80 0000f0),display:%2[2.0d]% %chart%
PROCESSCOUNT=interval:2,display:%1 processes| %2 handles\, %3 threads
TOPPROCESSCPU=interval:2,maxrows:5,text:Top Processes,display:%1 (pid:%2) %3[1.1f]%

# physical disks
PAGE=7
PAGE-TITLE=Physical Disks

COMMENT=color:%White%,style:iwb,text:Physical Disks
PHYSICALDRIVES=interval:60,font-size:90%,row-text:%1|%12,display:%3|%4|id: %5|Media: %9|Model: %10|Size: %14[1.0B]B\, Status: %15

# memory
PAGE=8
PAGE-TITLE=Memory
COLOR=%Cyan%

# ram module type lookup table
set ram0  = Unknown
set ram1  = Other
set ram2  = DRAM
set ram3  = Sync DRAM
set ram4  = Cache DRAM
set ram5  = EDO
set ram6  = EDRAM
set ram7  = VRAM
set ram8  = SRAM
set ram9  = RAM
set ram10 = ROM
set ram11 = Flash
set ram12 = EEPROM
set ram13 = FEPROM
set ram14 = EPROM
set ram15 = CDRAM
set ram16 = 3DRAM
set ram17 = SDRAM
set ram18 = SGRAM
set ram19 = RDRAM
set ram20 = DDR
set ram21 = DDR2
set ram22 = DDR2 FB-DIMM
set ram23 = Unknown
set ram24 = DDR3
set ram25 = FBD2

COMMENT=color:%White%,style:iwb,text:Memory
WMI=namespace:root\cimv2,query:Win32_PhysicalMemory,row-text:%BankLabel%,display:%Capacity%[1.0b]B %DeviceLocator% %ram%MemoryType%%|%Manufacturer%
COMMENT
PHYSICALRAM=interval:5,alarms:(%3 80 0000FF),chart:bar max:100 series1:3 threshold:80,display:%1[3.1b]B / %2[3.1b]B (%3% used)
TOPPROCESSMEM=interval:5,font-size:80%,counter:pu,maxrows:5,text:Top Process Mem,display:%1 (pid:%2) %3[1.1b]B
PAGEFILE=interval:5,display:%1[3.1b]B / %2[3.1b]B (%3% used)
PAGEFAULTS=interval:5,alarms:(%5 le 80 2222cc),text:Page Faults||Hit Rate,chart:line scale:100 series1:5 color1:22cccc,display:Total: %1/sec|Hard: %2\, Reads: %3\, Writes: %4|%5% %chart%
TOPPROCESSPF=interval:5,maxrows:5,font-size:80%,text:Top Processes PF,display:%1 (pid:%2) %3[1.2B] faults
COMMENT=text:,font-size:50%
VIRTUALMEMORY=interval:5,chart:bar max:100 series1:3 threshold:80,display:%1[3.1b]B / %2[3.1b]B (%3% used)
